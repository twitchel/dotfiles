#!/usr/bin/env zunit

@test 'Test source_file function can source existing files' {
  # Define the source_file function as it appears in bootstrap.zshrc
  source_file() {
    [ -f "$1" ] && source "$1"
  }
  
  # Create a test file to source
  local test_file="/tmp/test_source_$$.sh"
  echo 'export TEST_SOURCE_VAR=sourced' > "${test_file}"
  
  # Call source_file with the test file
  source_file "${test_file}"
  
  # Assert that the variable was set
  assert "${TEST_SOURCE_VAR}" same_as 'sourced'
  
  # Cleanup
  rm -f "${test_file}"
}

@test 'Test source_file function definition' {
  # Define the source_file function
  source_file() {
    [ -f "$1" ] && source "$1"
  }
  
  # Check that the function exists
  run type source_file
  
  # Assert function is defined
  assert $state equals 0
}
